<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mask Drift ML5</title>

    <!-- import tweakpane -->
    <script type="module">
      // import the library as a module
      import { Pane } from "https://cdn.jsdelivr.net/npm/tweakpane@4.0.5/dist/tweakpane.min.js";
      // then, add it to the "browser" so that it can be used as "global."
      window.Pane = Pane;
    </script>

    <script src="https://cdn.jsdelivr.net/npm/p5@1.11.11/lib/p5.js"></script>
    <script src="https://unpkg.com/ml5@1/dist/ml5.min.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=M+PLUS+1p:wght@400;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/tweakpane@4.0.5/dist/tweakpane.min.css"
    />
    <link rel="icon" type="image/png" sizes="5x5" href="assets/favicon/favicon.png" />
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <div id="app">
      <div id="stage">
        <div id="canvas-wrap"></div>
        <div id="empty-state" aria-live="polite">
          <div class="empty-title">Mask Drift ML5</div>
          <div class="empty-sub">
            Pick a sample image or drop a local JPG/PNG to start.
          </div>
        </div>
      </div>
      <aside id="ui" class="is-collapsed" aria-label="controls">
        <div class="ui-header">
          <div class="ui-title">Mask Drift ML5</div>
          <button id="togglePanel" type="button">Hide Panel</button>
        </div>
        <div class="ui-block">
          <label class="ui-label" for="sampleSelect">Sample Image</label>
          <select id="sampleSelect"></select>
          <button id="refreshSamples" type="button">Reload Samples</button>
        </div>
        <div class="ui-block">
          <label class="ui-label" for="fileInput">Local Image</label>
          <div
            id="dropZone"
            class="drop-zone"
            role="button"
            tabindex="0"
            aria-label="Drop file or click to browse"
          >
            <div class="drop-zone-text">Drop file or click to browse</div>
            <input id="fileInput" type="file" accept=".jpg,.jpeg,.png,image/jpeg,image/png" />
          </div>
          <div class="ui-note">
            Local images are processed in your browser only.
          </div>
        </div>
        <div class="ui-block ui-actions">
          <button id="playButton" type="button">Run</button>
          <button id="stopButton" type="button">Stop</button>
        </div>
        <div class="ui-block">
          <details id="statusTab" class="ui-status-tab">
            <summary>Status</summary>
            <div class="ui-status">
              <div class="ui-status-row">
                <div class="ui-label">Status</div>
                <div id="statusValue">LOADING_MODEL</div>
              </div>
              <div class="ui-status-row">
                <div class="ui-label">Detail</div>
                <div id="detailValue"></div>
              </div>
              <div class="ui-status-row">
                <div class="ui-label">Progress</div>
                <div id="progressValue"></div>
              </div>
            </div>
          </details>
        </div>
        <div class="ui-block">
          <div class="ui-label">Parameters</div>
          <div id="pane"></div>
        </div>
        <div class="ui-shortcuts">p: Toggle panel / s: Save PNG</div>
      </aside>
    </div>
    <div id="socialButtons">
      <a
        id="followButton"
        href="https://x.com/dn0t_"
        target="_blank"
        rel="noopener noreferrer"
      >
        Follow
      </a>
      <a
        id="repoButton"
        href="https://github.com/ogrew/p5-bodymask-drift"
        target="_blank"
        rel="noopener noreferrer"
      >
        GitHub
      </a>
    </div>

    <script src="src/config.js"></script>
    <script src="src/state.js"></script>
    <script src="src/utils.js"></script>
    <script src="src/mask.js"></script>
    <script src="src/image.js"></script>

    <script src="src/particles/CellParticle.js"></script>
    <script src="src/particles/build.js"></script>
    <script src="src/segmentation.js"></script>
    <script src="src/ui.js"></script>

    <script src="src/main.js"></script>
  </body>
</html>
